https://www.cs.princeton.edu/~chazelle/pubs/ReportingCountingSegIntersect.pdf